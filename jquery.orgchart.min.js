(function(a){function n(b,f,g,c,d){var p=a("<table cellpadding='0' cellspacing='0' border='0'/>"),j=a("<tbody/>"),m=a("<tr/>").addClass("nodes"),h=a("<td/>").addClass("node").attr("colspan",2),e=b.children("ul:first").children("li");1<e.length&&h.attr("colspan",2*e.length);var k=a("<h2>").html(d.nodeText(b));c=a("<div>").addClass("node").addClass("level"+g).addClass("node"+c).addClass("level"+g+"-node"+c).append(k);d.copyClasses&&c.addClass(b.attr("class"));d.copyData&&c.data(b.data());d.copyStyles&&
c.attr("style",b.attr("style"));d.copyTitle&&c.attr("title",b.attr("title"));c.data("orgchart-level",g).data("orgchart-node",b);h.append(c);m.append(h);j.append(m);c.click(function(){var c=a(this);d.nodeClicked(c.data("orgchart-node"));if(d.interactive){var b=c.closest("tr");b.next("tr").is(":visible")?(d.fade?b.nextAll("tr").fadeOut(d.speed):b.nextAll("tr").hide(),c.removeClass("shownChildren").addClass("hiddenChildren")):(c.removeClass("hiddenChildren").addClass("shownChildren"),d.fade?b.nextAll("tr").fadeIn(d.speed):
b.nextAll("tr").show())}});if(0<e.length){if(-1==d.depth||g+1<d.depth){b=a("<tr/>").addClass("lines");h=a("<td/>").attr("colspan",2*e.length);b.append(h);k=a("<table cellpadding='0' cellspacing='0' border='0'>");k.append("<tbody>");var q=a("<tr/>").addClass("lines x"),s=a("<td>").addClass("line left"),t=a("<td>").addClass("line right");q.append(s).append(t);k.children("tbody").append(q);h.append(k);j.append(b);0<e.length&&(c.addClass("hasChildren"),-1==d.showLevels||g<d.showLevels-1?c.addClass("shownChildren"):
c.addClass("hiddenChildren"),d.interactive&&c.hover(function(){a(this).addClass(d.hoverClass)},function(){a(this).removeClass(d.hoverClass)}));var l=a("<tr/>").addClass("lines v");e.each(function(){var c=a("<td/>").addClass("line left top"),d=a("<td/>").addClass("line right top");l.append(c).append(d)});l.find("td:first").removeClass("top");l.find("td:last").removeClass("top");j.append(l);var r=a("<tr/>");e.each(function(c){var b=a("<td/>");b.attr("colspan",2);n(a(this),b,g+1,c,d);r.append(b)})}else d.stack&&
(e=e.clone(),e=a("<ul class='stack'>").append(e),c.after(e));j.append(r)}-1<d.showLevels&&g>=d.showLevels-1&&m.nextAll("tr").hide();p.append(j);f.append(p)}a.fn.orgChart=function(b){var f=a.extend({},a.fn.orgChart.defaults,b);return this.each(function(){$this=a(this).clone();-1<f.levels&&$this.find("ul").andSelf().filter(function(){return a(this).parents("ul").length+1>f.levels}).remove();var b=a("<div class='"+f.chartClass+"'/>");f.interactive&&b.addClass("interactive");$this.is("ul")&&n($this.find("li:first"),
b,0,0,f);b.find("div.node a").click(function(a){a.stopImmediatePropagation()});f.container.append(b)})};a.fn.orgChart.defaults={container:a("body"),depth:-1,levels:-1,showLevels:-1,stack:!1,chartClass:"orgChart",hoverClass:"hover",nodeText:function(a){return a.clone().children("ul,li").remove().end().html()},interactive:!1,fade:!1,speed:"slow",nodeClicked:function(){},copyClasses:!0,copyData:!0,copyStyles:!0,copyTitle:!0}})(jQuery);
